## Android MQTT连接故障排查指南

### 当前状况
- ✅ MQTT服务器运行正常 (192.168.13.217:1883)
- ✅ 服务器监听所有网络接口 (0.0.0.0:1883)
- ✅ 从电脑可以正常连接和发送消息
- ❌ Android app显示"已连接"但服务器没有收到连接
- ❌ 没有收到任何注册消息或心跳消息

### 可能的问题和解决方案

#### 1. 网络连接问题
**症状**: Android设备无法访问192.168.13.217
**检查方法**: 
- 确认Android设备和电脑在同一WiFi网络
- 在Android设备上ping 192.168.13.217
- 或在Android浏览器访问 http://192.168.13.217:5001/health

**解决方案**:
- 连接到相同的WiFi网络
- 如果使用模拟器，确保网络桥接正确

#### 2. Android app配置问题
**症状**: app连接到错误的服务器或端口
**检查方法**: 查看app内部的MQTT配置

**解决方案**:
- 在Android app中手动设置MQTT服务器为 192.168.13.217:1883
- 或者尝试使用电脑的其他IP地址

#### 3. MQTT库问题
**症状**: app显示连接但实际没有连接
**可能原因**: Eclipse Paho MQTT库的异常状态

**解决方案**:
- 重启Android app
- 清除app数据和缓存
- 重新安装app

#### 4. 防火墙/权限问题
**症状**: 连接被阻止
**解决方案**:
- 检查Android设备的网络权限
- 检查Windows防火墙是否阻止1883端口

### 调试步骤

1. **首先确认网络连通性**:
   在Android设备浏览器访问: http://192.168.13.217:5001/health
   如果无法访问，说明网络不通

2. **如果网络通畅，尝试手动配置**:
   在Android app中找到MQTT设置，确认服务器地址

3. **尝试其他IP地址**:
   如果有多个网卡，尝试使用其他IP地址

### 临时解决方案

如果网络问题无法解决，可以考虑：
1. 使用公网MQTT服务器进行测试
2. 在Android模拟器中运行app (确保能访问localhost)
3. 修改MQTT服务器监听localhost，然后通过USB调试

### 下一步
请确认:
1. Android设备能否访问 http://192.168.13.217:5001/health
2. Android app中显示的MQTT服务器地址是什么
3. 是否使用了真机还是模拟器
